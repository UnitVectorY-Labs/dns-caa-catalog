<div class="intro-box">
    <p class="intro-text"><a href="https://datatracker.ietf.org/doc/html/rfc8659" target="_blank" class="link-primary underline">CAA (Certification Authority Authorization)</a> records allow domain owners to specify which Certificate Authorities are permitted to issue certificates for their domain. By setting CAA records, organizations can prevent unauthorized certificate issuance and strengthen their security posture. This catalog surveys CAA deployment across the top 10,000 domains to provide insight into real-world adoption patterns.</p>
</div>

<div class="summary-box">
    <h3 class="mt-0 text-primary">CAA Statistics Summary</h3>
    
    <div class="grid-auto-fit-200">
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.TotalDomains}}</div>
            <div class="text-muted">Total Domains</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-green">{{.Summary.DomainsWithCAA}}</div>
            <div class="text-muted">With CAA Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithCAA 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithIssue}} ‚úÖ</div>
            <div class="text-muted">With 'issue' Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithIssue 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithIssueWild}} ‚ú≥Ô∏è</div>
            <div class="text-muted">With 'issuewild' Record</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithIssueWild 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithIodef}} üì¨</div>
            <div class="text-muted">With 'iodef' Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithIodef 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithIssueMail}} üìß</div>
            <div class="text-muted">With 'issuemail' Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithIssueMail 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithContactEmail}} üì©</div>
            <div class="text-muted">With 'contactemail' Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithContactEmail 100.0) .Summary.TotalDomains)}}</div>
        </div>
        <div class="card text-center">
            <div class="text-2xl font-bold text-primary">{{.Summary.DomainsWithContactPhone}} üìû</div>
            <div class="text-muted">With 'contactphone' Records</div>
            <div class="text-sm text-muted">{{printf "%.1f%%" (div (mul .Summary.DomainsWithContactPhone 100.0) .Summary.TotalDomains)}}</div>
        </div>
    </div>
</div>

{{if or .Summary.SortedIssueStats .Summary.SortedIssueWildStats}}
<div class="summary-box">
    <h3 class="mt-0 text-primary">Top Certificate Authorities</h3>
    <div class="grid-two-col mb-15">
        {{if .Summary.SortedIssueStats}}
        <div>
            <h4 class="text-primary mb-05">‚úÖ issue</h4>
            <div class="table-wrapper mb-15">
                <table class="table-full">
                    <thead class="sticky-header">
                        <tr class="table-header">
                            <th>Certificate Authority</th>
                            <th class="text-right">Count</th>
                            <th class="text-right">%</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Summary.SortedIssueStats}}
                        <tr class="table-row">
                            <td class="table-cell">
                                <a href="/providers/{{normalizeCA .CA}}.html" 
                                   hx-get="/snippets/providers/{{normalizeCA .CA}}.html" 
                                   hx-target="#content" 
                                   hx-push-url="/providers/{{normalizeCA .CA}}.html" 
                                   class="link-primary">{{.CA}}</a>
                            </td>
                            <td class="table-cell text-right">{{.Count}}</td>
                            <td class="table-cell text-right">{{printf "%.1f" (div (mul .Count 100.0) $.Summary.TotalDomains)}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
        {{end}}

        {{if .Summary.SortedIssueWildStats}}
        <div>
            <h4 class="text-primary mb-05">‚ú≥Ô∏è issuewild</h4>
            <div class="table-wrapper mb-15">
                <table class="table-full">
                    <thead class="sticky-header">
                        <tr class="table-header">
                            <th>Certificate Authority</th>
                            <th class="text-right">Count</th>
                            <th class="text-right">%</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Summary.SortedIssueWildStats}}
                        <tr class="table-row">
                            <td class="table-cell">
                                <a href="/providers/{{normalizeCA .CA}}.html" 
                                   hx-get="/snippets/providers/{{normalizeCA .CA}}.html" 
                                   hx-target="#content" 
                                   hx-push-url="/providers/{{normalizeCA .CA}}.html" 
                                   class="link-primary">{{.CA}}</a>
                            </td>
                            <td class="table-cell text-right">{{.Count}}</td>
                            <td class="table-cell text-right">{{printf "%.1f" (div (mul .Count 100.0) $.Summary.TotalDomains)}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
        {{end}}
    </div>
</div>
{{end}}
