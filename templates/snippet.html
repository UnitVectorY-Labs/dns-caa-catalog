<div class="page-header page-header-domain">
    <h2 class="page-header-title">{{.DomainResult.Domain}}</h2>
    <div class="page-header-subtitle">Domain CAA Records</div>
</div>
{{if .IsCAProvider}}
<div class="cross-link-section">
    <span class="cross-link-icon">üîó</span>
    <span class="cross-link-text">This domain is also a Certificate Authority.</span>
    <a href="/providers/{{.NormalizedCA}}.html" 
       hx-get="/snippets/providers/{{.NormalizedCA}}.html" 
       hx-target="#content" 
       hx-push-url="/providers/{{.NormalizedCA}}.html" 
       class="cross-link-button">View CA Page ‚Üí</a>
</div>
{{end}}
{{if .DomainResult.Error}}
<div class="error">Error: {{.DomainResult.Error}}</div>
{{else}}
<div class="summary-box">
    <h3 class="mt-0 text-primary">CAA Records</h3>
    <div class="records-table-wrapper">
    <table class="records-table">
        <tbody>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">‚úÖ</span>
                    <span class="record-name">issue</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc8659#section-4.2" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.Issue}}
                    <div class="record-list">
                        {{range .DomainResult.Issue}}
                        <a href="/providers/{{normalizeCA .}}.html" 
                           hx-get="/snippets/providers/{{normalizeCA .}}.html" 
                           hx-target="#content" 
                           hx-push-url="/providers/{{normalizeCA .}}.html" 
                           class="link-primary">{{.}}</a>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">‚ú≥Ô∏è</span>
                    <span class="record-name">issuewild</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc8659#section-4.3" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.IssueWild}}
                    <div class="record-list">
                        {{range .DomainResult.IssueWild}}
                        <a href="/providers/{{normalizeCA .}}.html" 
                           hx-get="/snippets/providers/{{normalizeCA .}}.html" 
                           hx-target="#content" 
                           hx-push-url="/providers/{{normalizeCA .}}.html" 
                           class="link-primary">{{.}}</a>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">üìß</span>
                    <span class="record-name">issuemail</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc9495#section-3" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.IssueMail}}
                    <div class="record-list">
                        {{range .DomainResult.IssueMail}}
                        <span>{{.}}</span>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">üì¨</span>
                    <span class="record-name">iodef</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc8659#section-4.4" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.Iodef}}
                    <div class="record-list">
                        {{range .DomainResult.Iodef}}
                        <span>{{.}}</span>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">üì©</span>
                    <span class="record-name">contactemail</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc8659#section-4.5" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.ContactEmail}}
                    <div class="record-list">
                        {{range .DomainResult.ContactEmail}}
                        <span>{{.}}</span>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
            <tr class="record-row">
                <td class="record-label">
                    <span class="record-emoji">üìû</span>
                    <span class="record-name">contactphone</span>
                    <a href="https://datatracker.ietf.org/doc/html/rfc8659#section-4.6" target="_blank" class="rfc-link">RFC</a>
                </td>
                <td class="record-value">
                    {{if .DomainResult.ContactPhone}}
                    <div class="record-list">
                        {{range .DomainResult.ContactPhone}}
                        <span>{{.}}</span>
                        {{end}}
                    </div>
                    {{else}}
                    <span class="text-muted">No record</span>
                    {{end}}
                </td>
            </tr>
        </tbody>
    </table>
    </div>
</div>

{{if .DomainResult.Records}}
<div class="summary-box">
    <h3 class="mt-0 text-primary">Raw CAA DNS Response</h3>
    <pre class="raw-records-content">{{range .DomainResult.Records}}{{.}}
{{end}}</pre>
</div>
{{end}}

{{if not (or .DomainResult.Issue .DomainResult.IssueWild .DomainResult.Iodef .DomainResult.IssueMail .DomainResult.ContactEmail .DomainResult.ContactPhone .DomainResult.Records)}}
<p class="text-muted">No CAA records found for this domain.</p>
{{end}}

<div class="data-attribution">
    Domain ranking data from <a href="https://radar.cloudflare.com/domains" target="_blank">Cloudflare Radar</a> used under <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a>.
</div>
{{end}}
